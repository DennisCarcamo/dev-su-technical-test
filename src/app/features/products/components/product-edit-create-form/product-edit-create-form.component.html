<div class="main-component">
  <app-table-header
    [title]="isEditMode ? 'Editar Producto' : 'Crear Producto'"
  ></app-table-header>
  <form
    *ngIf="registrationForm"
    class="registration-form"
    [formGroup]="registrationForm"
    (ngSubmit)="onSubmit()"
  >
    <div class="form-row">
      <div class="form-group">
        <label for="id" class="form-label">ID</label>
        <input
          [attr.disabled]="isEditMode ? true : null"
          type="text"
          id="id"
          class="form-input"
          placeholder="ej: 3YP"
          [class.error]="
            hasError('id', 'required') ||
            hasError('id', 'maxlength') ||
            hasError('id', 'minlength')
          "
          formControlName="id"
        />
        <span *ngIf="hasError('id', 'required')" class="error-message"
          >ID es requerido</span
        >
        <span *ngIf="hasError('id', 'minlength')" class="error-message"
          >Debe tener más de 3 caracteres</span
        >
        <span *ngIf="hasError('id', 'maxlength')" class="error-message"
          >Debe tener menos de 10 caracteres</span
        >
      </div>

      <div class="form-group">
        <label for="name" class="form-label">Nombre</label>
        <input
          type="text"
          id="name"
          class="form-input"
          formControlName="name"
          placeholder="ej. Cuenta ahorro"
          [class.error]="
            hasError('name', 'required') ||
            hasError('name', 'minlength') ||
            hasError('name', 'maxlength')
          "
        />

        <span *ngIf="hasError('name', 'required')" class="error-message">
          Este campo es requerido
        </span>
        <span *ngIf="hasError('name', 'minlength')" class="error-message">
          Debe tener más de 5 caracteres
        </span>
        <span *ngIf="hasError('name', 'maxlength')" class="error-message">
          Debe tener menos de 100 caracteres
        </span>
      </div>
    </div>

    <div class="form-row">
      <div class="form-group">
        <label for="description" class="form-label">Descripción</label>
        <input
          type="text"
          id="description"
          class="form-input"
          placeholder="ej. Cuenta de ahorro con tasa de interés"
          [class.error]="
            hasError('description', 'required') ||
            hasError('description', 'minlength') ||
            hasError('description', 'maxlength')
          "
          formControlName="description"
        />
        <span *ngIf="hasError('description', 'required')" class="error-message">
          Este campo es requerido
        </span>
        <span
          *ngIf="hasError('description', 'minlength')"
          class="error-message"
        >
          Debe tener más de 10 caracteres
        </span>
        <span
          *ngIf="hasError('description', 'maxlength')"
          class="error-message"
        >
          Debe tener menos de 200 caracteres
        </span>
      </div>

      <div class="form-group">
        <label for="logo" class="form-label">Logo</label>
        <input
          type="text"
          id="logo"
          class="form-input"
          placeholder="ej. https://mi-logo.com/logo.png"
          [class.error]="hasError('logo', 'required')"
          formControlName="logo"
        />
        <span *ngIf="hasError('logo', 'required')" class="error-message">
          Este campo es requerido
        </span>
      </div>
    </div>

    <div class="form-row">
      <div class="form-group">
        <label for="releaseDate" class="form-label">Fecha Liberación</label>
        <input
          type="text"
          id="releaseDate"
          class="form-input"
          formControlName="releaseDate"
          placeholder="ej. 2026-12-31"
          [class.error]="
            hasError('releaseDate', 'required') ||
            hasError('releaseDate', 'iso8601') ||
            hasError('releaseDate', 'futureDate')
          "
        />
        <span *ngIf="hasError('releaseDate', 'required')" class="error-message">
          Este campo es requerido
        </span>
        <span *ngIf="hasError('releaseDate', 'iso8601')" class="error-message">
          La fecha debe ser formato ISO 8601 (YYYY-MM-DD).
        </span>
        <span
          *ngIf="hasError('releaseDate', 'futureDate')"
          class="error-message"
        >
          La fecha debe ser el futuro.
        </span>
      </div>

      <div class="form-group">
        <label for="reviewDate" class="form-label">Fecha Revisión</label>
        <input
          type="text"
          id="reviewDate"
          class="form-input"
          formControlName="reviewDate"
          placeholder="ej. 2026-12-31"
          [class.error]="
            hasError('reviewDate', 'required') ||
            hasError('reviewDate', 'iso8601') ||
            hasError('reviewDate', 'futureDate')
          "
        />
        <span *ngIf="hasError('reviewDate', 'required')" class="error-message">
          Este campo es requerido
        </span>
        <span *ngIf="hasError('reviewDate', 'iso8601')" class="error-message">
          La fecha debe ser formato ISO 8601 (YYYY-MM-DD).
        </span>
        <span
          *ngIf="hasError('reviewDate', 'futureDate')"
          class="error-message"
        >
          La fecha debe ser el futuro.
        </span>
      </div>
    </div>

    <div class="form-actions">
      <button
        *ngIf="!isEditMode"
        type="button"
        class="btn btn-secondary"
        (click)="onReset()"
      >
        Reiniciar
      </button>
      <button type="submit" class="btn btn-primary">Enviar</button>
    </div>
  </form>
</div>

<app-modal
  [title]="modalTitle"
  [subtitle]="modalMessage"
  [isOpen]="isModalOpen"
  [type]="modalType"
  (closed)="onCloseModal()"
>
</app-modal>
